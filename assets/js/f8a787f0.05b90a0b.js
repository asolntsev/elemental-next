"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1313],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),u=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(r),h=a,m=c["".concat(i,".").concat(h)]||c[h]||d[h]||l;return r?n.createElement(m,o(o({ref:t},p),{},{components:r})):n.createElement(m,o({ref:t},p))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,o=new Array(l);o[0]=h;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[c]="string"==typeof e?e:a,o[1]=s;for(var u=2;u<l;u++)o[u]=r[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},95147:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var n=r(87462),a=(r(67294),r(3905));const l={hide_table_of_contents:!0,publish_date:new Date("2014-03-18T00:00:00.000Z"),last_update:{date:new Date("2023-03-20T00:00:00.000Z")},level:2,language:"ruby"},o=void 0,s={unversionedId:"one-test-multiple-browsers-parallel/ruby",id:"one-test-multiple-browsers-parallel/ruby",title:"ruby",description:"A Solution",source:"@site/docs/42-one-test-multiple-browsers-parallel/ruby.md",sourceDirName:"42-one-test-multiple-browsers-parallel",slug:"/one-test-multiple-browsers-parallel/ruby",permalink:"/docs/one-test-multiple-browsers-parallel/ruby",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/42-one-test-multiple-browsers-parallel/ruby.md",tags:[],version:"current",lastUpdatedBy:"Diego Molina",lastUpdatedAt:1679270400,formattedLastUpdatedAt:"Mar 20, 2023",frontMatter:{hide_table_of_contents:!0,publish_date:"2014-03-18T00:00:00.000Z",last_update:{date:"2023-03-20T00:00:00.000Z"},level:2,language:"ruby"}},i={},u=[{value:"A Solution",id:"a-solution",level:2},{value:"Example",id:"example",level:2},{value:"Expected Behavior",id:"expected-behavior",level:2},{value:"Summary",id:"summary",level:2},{value:"About The Author",id:"about-the-author",level:2}],p={toc:u},c="wrapper";function d(e){let{components:t,...r}=e;return(0,a.kt)(c,(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"a-solution"},"A Solution"),(0,a.kt)("p",null,"Let's remedy this by taking ",(0,a.kt)("a",{parentName:"p",href:"https://elementalselenium.com/docs/one-test-multiple-browsers/41-one-test-multiple-browsers"},"the previous tip's example"),"\nand parallelize it with the help of ",(0,a.kt)("a",{parentName:"p",href:"http://www.tutorialspoint.com/ruby/ruby_multithreading.htm"},"threads"),"."),(0,a.kt)("h2",{id:"example"},"Example"),(0,a.kt)("p",null,"Our initial setup stays mostly the same. There are only a couple of minor changes we'll need to make."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},"ENV['SAUCE_USERNAME'] = 'your username'\nENV['SAUCE_API_KEY']  = 'your api key'\n\nrequire 'selenium-webdriver'\nrequire 'rspec/expectations'\n\ndef setup(browser_name, browser_version)\n  caps = Selenium::WebDriver::Remote::Capabilities.send(browser_name.to_sym)\n  caps.platform = 'Windows XP'\n  caps.version = browser_version.to_s\n\n  Thread.current[:driver] = Selenium::WebDriver.for(\n    :remote,\n    url: \"https://#{ENV['SAUCE_USERNAME']}:#{ENV['SAUCE_API_KEY']}@ondemand.saucelabs.com/wd/hub\",\n    desired_capabilities: caps)\nend\n\ndef teardown\n  Thread.current[:driver].quit\nend\n")),(0,a.kt)("p",null,"Since we are working with threads, we will need to use variables that are thread safe. The best candidates are\nthread local variables. They have a global scope (similar to global variables) but are only accessible from within\nthe thread that created it. This way we won't run into any odd collisions across simultaneous test runs."),(0,a.kt)("p",null,"So instead of instance variables (e.g., ",(0,a.kt)("inlineCode",{parentName:"p"},"@driver"),") we are now storing each instance of Selenium in this new kind of\nvariable and referencing it as needed (e.g., ",(0,a.kt)("inlineCode",{parentName:"p"},"Thread.current[:driver]"),")."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},"# filename: example42.rb\n\nBROWSERS = { firefox: '27',\n             chrome: '32',\n             internet_explorer: '8' }\n\ndef run\n  threads = []\n  BROWSERS.each_pair do |browser, browser_version|\n    threads << Thread.new do\n      setup(browser, browser_version)\n      yield\n      teardown\n    end\n  end\n  threads.each { |thread| thread.join }\nend\n")),(0,a.kt)("p",null,"Our browser list remains untouched, but our ",(0,a.kt)("inlineCode",{parentName:"p"},"run")," method has been updated to spawn and join threads (which is how\nyou finish a thread). With this setup a new thread will be spawned for each of the browsers in the list, perform\nits actions, and finish."),(0,a.kt)("p",null,"Will all of that in place, we just need to update our test to use the new thread local driver variable."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},"run do\n  Thread.current[:driver].get 'https://the-internet.herokuapp.com'\n  Thread.current[:driver].title.should == 'The Internet'\nend\n")),(0,a.kt)("p",null,"If we run this script from the command line (",(0,a.kt)("inlineCode",{parentName:"p"},"ruby examle42.rb"),") and head over\n",(0,a.kt)("a",{parentName:"p",href:"https://saucelabs.com/account"},"the Sauce Labs Account page"),", then we should see three tests running simultaneously."),(0,a.kt)("p",null,"NOTE: the number of parallel sessions allotted to your Sauce Labs account will dictate how quickly your tests will\nfinish. For instance, if you add two new browsers to ",(0,a.kt)("inlineCode",{parentName:"p"},"BROWSER_LIST")," and run this, only 3 sessions will run in Sauce\nLabs, queuing the other two until some of the original sessions finish."),(0,a.kt)("h2",{id:"expected-behavior"},"Expected Behavior"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Simultaneously loads each browser in a Sauce Labs job"),(0,a.kt)("li",{parentName:"ul"},"Each test loads the page and asserts the title is correct"),(0,a.kt)("li",{parentName:"ul"},"Each session closes when it is complete")),(0,a.kt)("h2",{id:"summary"},"Summary"),(0,a.kt)("p",null,"There are alternative ways to run your tests in parallel. Some more notable approaches include:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"through a test framework (e.g., TestNG in Java)"),(0,a.kt)("li",{parentName:"ul"},"through Continuous Integration"),(0,a.kt)("li",{parentName:"ul"},"through a third-party library (e.g., ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/grosser/parallel_tests"},"parallel_tests in Ruby"),").")),(0,a.kt)("p",null,"For a full write-up on how to parallel_tests, check out ",(0,a.kt)("a",{parentName:"p",href:"https://elementalselenium.com/docs/parallel/27-parallel"},"tip 27"),"."),(0,a.kt)("p",null,"Happy Testing!"),(0,a.kt)("h2",{id:"about-the-author"},"About The Author"),(0,a.kt)("p",null,"Dave Haeffner is the original writer of Elemental Selenium -- a free, once weekly Selenium tip newsletter that's\nread by thousands of testing professionals. He also created and maintains the-internet (an open-source web app\nthat's perfect for writing automated tests against)."),(0,a.kt)("p",null,"Dave has helped numerous companies successfully implement automated acceptance testing; including The Motley Fool,\nManTech International, Sittercity, and Animoto. He is also an active member of the Selenium project and has spoken\nat numerous conferences and meetups around the world about automated acceptance testing."))}d.isMDXComponent=!0}}]);